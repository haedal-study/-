# 컴퓨터 구조를 공부해야 하는 이유

## 왜 공부해야 하는가?

(개인적인 의견입니다.)

### **1. 문제 해결의 깊이를 키울 수 있다.**

프로그래밍을 하다보면 여러가지 에러를 만나게 됩니다. 소프트웨어 수준에서 해결가능한 에러들도 있지만, 좀 더 깊은 레벨까지 들어가야 해결할 수 있는 에러들도 존재합니다. 컴퓨터 구조를 공부하면 좀 더 다양한 문제를 해결할 수 있습니다.

관련 게시글: [CTO가 커리어를 걸고 비트 레벨까지 내려가서 DB를 해킹했던 이야기](https://tech.devsisters.com/posts/bit-level-database-hacking/)

### 2. 성능, 용량, 비용을 고려할 수 있다.

서버를 구축하기 위해서 성능, 용량, 비용등은 필연적으로 고려해야합니다. 이는 온프레미스 환경뿐만이 아닌 클라우드 환경에서도 여전한 상황입니다. 이 밖에도 프로그래밍 언어 작성, DB 활용 등 다양한 상황에서도 성능, 용량, 비용을 고려해야 하며, 컴퓨터 구조를 공부하여 이들을 적절히 고려할 수 있다면 좋은 개발자가 될 수 있을 것입니다.

### 3. 컴퓨터 구조를 응용한 기술을 빠르게 이해할 수 있다.

개발자가 되기 위해 학습을 하다보면 컴퓨터 구조를 응용한 다양한 기술들을 만나게 됩니다.

e.g. JVM에서의 program counter(CPU 내에 있는 레지스터), JPA에서의 1차 캐시 (가상 메모리와 유사)

컴퓨터 구조를 제대로 학습하지 않는다면 이러한 기술들을 만났을 때 위축되게 되고, 자신감을 잃어버려 빠르게 이해하기에 어려움을 느끼게 됩니다.

# 컴퓨터 구조 입문

## 컴퓨터 구조와 컴퓨터의 정의

**컴퓨터 구조**(Computer Architecture)는 컴퓨터가 제 기능을 하기 위해 구성요소들과 그 구성요소들간의 상호작용을 통해서 컴퓨터를 동작시키는 원리에 대한 학문입니다.

**컴퓨터**는 산술적인 연산(e.g. `+`, `-`, `*`, `/`) 과 논리적인 연산( `and`, `or` , `not` )을 통해 사용자가 원하는 결과를 얻도록 돕는 기계 장치입니다.

## 컴퓨터의 구성요소

컴퓨터는 여러 구성요소들의 상호작용으로 동작합니다.

핵심적인 구성요소는 아래와 같습니다.

### CPU

컴퓨터의 두뇌 역할로 입력으로 들어온 연산을 비롯한 여러 명령어들을 수행하고 그 결과를 출력하는 장치입니다. ALU, Control Unit(제어 장치), Register 등으로 구성되어 있습니다.

**ALU**는 덧셈, 뺄셈, 비트이동 등의 가장 작은 단위의 연산을 수행하는 주체입니다.

**Control Unit**은 명령어를 해석하고 실행시키는 주체입니다.

**Register**는 CPU가 명령을 수행하기 위해 데이터들을 저장하는 저장소입니다. 속도는 빠르나, 비용이 비싸 많이 대 용량으로 사용하지는 않습니다.

### 주기억장치 (Main Memory)

실행되는 프로그램(프로세스)가 저장되는 장소입니다. 프로그램의 코드, 프로그램 내에서 발생하는 변수 값들, 객체들, 메타 데이터들이 이곳에 저장됩니다.  컴퓨터 종료시 데이터들이 사라지는 **휘발성** 특성을 지니고 있습니다.

### 보조기억장치 (Secondary Storage)

비휘발성인 저장장치입니다. 

레지스터 → 주기억장치 → 보조기억장치 순으로 속도가 느리지만 가격이 저렴하여 피라미드와 같이 계층적으로 사용하고 있습니다.

### 입출력장치 (I/O Dedice)

사용자와 상호작용하는 장치들입니다. 키보드, 마우스 등과 같은 입력을 받거나 모니터, 스피커 등과같은 출력을 내는 장치들을 예로 들 수 있습니다.

### 메인보드와 시스템 버스

위에서 언급된 구성요소들이 상호작용을 할 수 있도록 돕는 부품들입니다. 

메인보드는 구성요소들이 부착할 수 있는 판이며, 시스템 버스는 구성요소 간 데이터나 신호를 전달할 수 있는 통로입니다.

Q. 레지스터는 저장장치인데 왜 CPU에 속하나요?

A. 구성요소들의 구분은 역할에 따른 구분이라고 생각합니다. 따라서 계산을 위한 임시저장의 목적인 레지스터가 CPU에 속했다고 생각합니다.

## 컴퓨터 구성요소 간의 상호작용

시스템 버스에서 소개했듯이, 구성요소 간 상호작용을 하기 위해서는 데이터와 신호를 전달합니다. 이 둘은 **컴퓨터가 이해할 수 있는 정보**인 1. 이진 데이터와 2. 데이터들을 통해 특정 동작을 실행시키는 명령어입니다.

# 컴퓨터와 바이너리

컴퓨터는 0과 1로 구성된 정보만을 식별할 수 있습니다.

이 둘을 통틀어 데이터를 나타내는 가장 작은 단위인 비트(bit)라고 부릅니다.

이러한 비트들이 8개 묶인 것을 바이트(byte)라고 부르며, 메모리에서 데이터를 관리하는 단위로써 사용합니다.

모르던 사실인데. 1000byte는 1kB라고 표현하고, 1024byte는 1KiB라고 표현한다고 한다.

## 이진법

컴퓨터는 0과 1을 이용하여 데이터를 표현하는데 이러한 방법을 이진법이라고 부릅니다.

01001 과 같은 이진수는 십진수로 하였을 때, 2^3 + 2^0 = 9로 해석됩니다.

**음수의 표현**

이진법에선 2의 보수를 사용하여 음수를 표현합니다.

**2의 보수**

2의 보수는 특정 수를 커다란 수에서 뺀 값을 의미합니다. 101(2)의 2의 보수는 011(2) 입니다.

이는 모든 0과 1을 뒤집고 1을 더하는 방법으로 쉽계 계산할 수 있습니다.

**1의 보수**

1의 보수는 특정 수의 대칭이 되는 수를 바로 보수로 여기며,  0과 1을 뒤집는 것만으로도 구할 수 있어 좀 더 편리해보이는데 2의 보수를 사용하는 이유는 뭘까요? 

그 까닭은 첫 번째로, +0 역시 -0이라는 보수를 갖기 때문이며, 두 번째로  ALU 내에 음수 계산이 복잡하기 때문입니다.

**16진법**

컴퓨터에선 0~9와 추가로 A~F를 이용하여 16진법으로 데이터를 표현하는 경우가 많습니다.

이는 컴퓨터가 2진수를 표현하기에 10진수보다 편리하기 때문이며, 사람이 10진수와 비슷한 방식으로 이해할 수 있기 때문입니다.

```html
int INT_MAX = 0x7fff'ffff; // (1 << 31) -1 을 쓸 수도 있습니다.
int INT_MIN = 0x8000'0000; // 1 << 31을 쓸 수도 있습니다.
```

와 같이 활용하기도 합니다. (알고리즘 풀 때)

# 컴퓨터에서 문자 표현

컴퓨터에서는 0과 1을 응용하여 우리가 일상생활에서 사용하는 문자들, 그 외 다양한 특수문자들을 표현합니다.

**용어 설명**

컴퓨터가 바이너리를 이해할 수 있는 문자들(Character Set)로 변환하는 과정을 인코딩(Encoding), 그 반대 과정을 디코딩(Decoding) 이라고 합니다.

### 문자 집합

**ASCII**

초창기에는 숫자 + 영어 + 일부 특수문자 총 2^7개를 7비트로 나타낼 수 있는 ASCII를 활용하였습니다.

**한글 인코딩**

이후 다른 언어권 사람들을 위한 인코딩 방식들이 생겨났습니다. 한글의 경우 하나의 완성된 글자를 2바이트 하나로 인코딩하는 완성형 인코딩과 2바이트 속에 초성, 중성, 종성을 따로 표현하는 인코딩 방식인 조합형 인코딩 방식이 있습니다. 

**EUC-KR**

완성형 인코딩 방식을 사용한 문자 집합이 EUC-KR이며, EUC-KR에 포함되지 못한 글자들이 있어 CP949가 이를 일부 보완하였습니다. (그럼에도 모든 한글을 표현하진 못했습니다.)

**유니코드**

여러 언어들을 하나의 문자집합을 유니코드 라고 합니다.

### UTF-8

유니코드에서는 다양한 방식으로 인코딩을 하는데, UTF-8은 문자 값의 범위에 따라 1 ~ 4바이트를 유동적으로 할당할 수 있습니다. (utf-16은 2~8q바이트를 할당할 수 있습니다.)

**utf8mb4**

mysql이라는 db는 기본 UTF-8이 1 ~ 3 바이트만을 사용합니다. 따라서 이모지(😂)와 같은 문자들을 표현할 수 없는 문제가 있었습니다. mysql에서 **utf8mb4**는 4바이트까지 사용하기위해 사용하는 인코딩방식입니다.

**collision**

대조라는 뜻으로, mysql에서 여러 문자열들의 순서를 비교할 때 사용한다. 

`text`: 바이너리 값 그대로 정렬

`utf8_general_ci`: 일반적인 사람들의 인식대로 정렬 (라틴 계열들을 사람의 인식에 맞게 정렬한다.)

`utf8_unicode_ci`: 유니코드 값에 따라 정렬

참고: https://sshkim.tistory.com/128

( `utf8_general_ci` 과 `utf8unicode_ci` 의 성능차이는 266% 정도로 상당하다고 한다. )

참고: https://www.dante2k.com/530

인코딩 관련 실제 문제: [https://velog.io/@sa1341/EUC-KR과-UTF-8을-알고가자](https://velog.io/@sa1341/EUC-KR%EA%B3%BC-UTF-8%EC%9D%84-%EC%95%8C%EA%B3%A0%EA%B0%80%EC%9E%90) (초반부) 

: 고객사가 전송한 파일의 이름이 ???로 잡혀 알고보았더니 문자 집합의 문제